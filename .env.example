# EDData - Environment Variables
# Copy this file to .env and adjust the values

# ========================================
# Domain Configuration
# ========================================
EDDATA_DOMAIN=eddata.dev

# ========================================
# Security Secrets (IMPORTANT!)
# ========================================
# Generate these values with:
# node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"

# Session Secret for Auth Service
EDDATA_SESSION_SECRET=

# JWT Secret for Token Signing
EDDATA_AUTH_JWT_SECRET=

# ========================================
# Frontier OAuth
# ========================================
# Frontier Developer Account: https://auth.frontierstore.net/developer
EDDATA_AUTH_CLIENT_ID=

# ========================================
# Service URLs (automatically generated)
# ========================================
# These are automatically generated from EDDATA_DOMAIN
# Only change if different URLs are needed

# EDDATA_API_BASE_URL=https://api.${EDDATA_DOMAIN}
# EDDATA_AUTH_BASE_URL=https://auth.${EDDATA_DOMAIN}
# EDDATA_WWW_BASE_URL=https://${EDDATA_DOMAIN}
# EDDATA_AUTH_COOKIE_DOMAIN=.${EDDATA_DOMAIN}
# EDDATA_DOWNLOADS_BASE_URL=

# ========================================
# Inter-Service Communication (Docker)
# ========================================
# Internal Docker network addresses for service-to-service communication
# EDDATA_COLLECTOR_HOST=eddata-collector
# EDDATA_COLLECTOR_LOCAL_PORT=3002

# ========================================
# Collector Configuration
# ========================================
# EDDN Server (default works in most cases)
# EDDN_SERVER=tcp://eddn.edcd.io:9500

# Database Paths (Container Paths)
# EDDATA_SYSTEMS_DB=/app/eddata-data/systems.db
# EDDATA_LOCATIONS_DB=/app/eddata-data/locations.db
# EDDATA_STATIONS_DB=/app/eddata-data/stations.db
# EDDATA_TRADE_DB=/app/eddata-data/trade.db

# Maintenance Window (UTC Time)
# Default: Sunday 2-6 AM
MAINTENANCE_DAY_OF_WEEK=0
MAINTENANCE_WINDOW_START_HOUR=2
MAINTENANCE_WINDOW_END_HOUR=6

# ========================================
# Performance Settings (12GB RAM Server)
# ========================================
# Skip startup maintenance for faster restarts (default: false)
# Snapshots and stats take 10-20 minutes with large DBs
SKIP_STARTUP_MAINTENANCE=false

# Skip slow regional commodity reports (default: true)
# Core Systems & Colonia reports take 5-10 minutes
SKIP_REGIONAL_COMMODITY_REPORTS=true

# Skip expensive index creation on startup (default: false)
# Only useful on first run to prevent startup delay
SKIP_EXPENSIVE_INDEXES=false

# Skip database integrity checks on startup (default: true)
# Only needed after crashes or corruption
SKIP_INTEGRITY_CHECKS=true

# Skip trade.db snapshots to prevent OOM kills (default: false for 12GB RAM)
# trade.db is 7GB+ and requires significant RAM for snapshotting
# Set to 'true' on servers with <16GB RAM
SKIP_TRADE_DB_SNAPSHOTS=false

# Node.js Memory Limit (MB) - Optimized for 12GB RAM server
# NODE_OPTIONS=--max-old-space-size=6144

# UV Thread Pool Size (default: 16)
# UV_THREADPOOL_SIZE=16

# ========================================
# Ports (Default Values)
# ========================================
# Only change if there are port conflicts

# EDDATA_COLLECTOR_LOCAL_PORT=3002
# EDDATA_API_LOCAL_PORT=3001
# EDDATA_AUTH_LOCAL_PORT=3003
# WWW runs on port 3000

# ========================================
# Directories (Container Paths)
# ========================================
# Default values work with Docker Volumes
# Only change if specific mount points are needed

# EDDATA_DATA_DIR=/app/eddata-data
# EDDATA_CACHE_DIR=/app/eddata-data/cache
# EDDATA_BACKUP_DIR=/app/eddata-backup
# EDDATA_DOWNLOADS_DIR=/app/eddata-downloads

# ========================================
# Node.js Environment
# ========================================
NODE_ENV=production

# ========================================
# Logging
# ========================================
# LOG_LEVEL=info

# ========================================
# NOTES
# ========================================
#
# 1. IMPORTANT: Change all EDDATA_SESSION_SECRET, EDDATA_AUTH_JWT_SECRET
#    and EDDATA_AUTH_CLIENT_ID before first start!
#
# 2. Generate secrets:
#    node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
#
# 3. Frontier OAuth Client ID:
#    Create a Developer Account: https://auth.frontierstore.net/developer
#    Callback URL: https://auth.YOUR-DOMAIN.com/callback
#
# 4. DNS Entries:
#    - eddata.dev (or your domain)
#    - www.eddata.dev
#    - api.eddata.dev
#    - auth.eddata.dev
#    - collector.eddata.dev (optional)
#
# 5. Startup Order:
#    Collector → API → Auth → WWW
#    (automatically managed by depends_on in docker-compose.yml)
#
# 6. Volumes:
#    - eddata-data: Databases and cache
#    - eddata-backup: Backup files
#    - eddata-downloads: Download files
#
# 7. Resource Requirements (12GB RAM Server):
#    - Collector: 10GB limit, 3GB reserved
#    - Memory distribution: 2.5GB Node.js + 3GB SQLite + 3GB OS + 1GB overhead
#    - Database size: ~5GB after 30-day retention cleanup
#
# 8. Dokploy Configuration:
#    - Use Docker Compose mode (not Stack)
#    - Configure domains in Dokploy UI for each service
#    - Environment variables are managed via Dokploy's .env editor
